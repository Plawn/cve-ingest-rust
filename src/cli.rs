use crate::{make_github_address, CveReader};

pub fn query_github(name: &str, versions: Vec<&str>, repo: &str, branch: &str) -> Option<Vec<String>> {
    let reader = CveReader::create(&make_github_address(repo, branch))
        .expect("failed to open cve reader");
    reader.get_cves_by_cots(name, versions)
}

pub fn query_local(name: &str, versions: Vec<&str>, path: &str) -> Option<Vec<String>> {
    let reader = CveReader::create(&format!("file://{}", path))
        .expect("failed to open cve reader");
    reader.get_cves_by_cots(name, versions)
}
